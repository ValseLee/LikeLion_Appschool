### Closure
---

### í´ë¡œì €..?
- í•¨ìˆ˜ì˜ ì´ë¦„ì´ë‚˜ ì„ ì–¸ì—†ì´ ì¤‘ê´„í˜¸ ë‚´ì— ì •ì˜ëœ ë…ë¦½ì ì¸ ì½”ë“œë¸”ë¡ì´ë‹¤.
    + ë§¤ê°œë³€ìˆ˜ì™€ ë°˜í™˜íƒ€ìž…ì€ ê´„í˜¸ ë‚´ì— í‘œí˜„í•˜ê³  í´ë¡œì € ë‚´ë¶€ì˜ í”„ë¡œê·¸ëž¨ì€ `in` í‚¤ì›Œë“œë¡œ ì‹œìž‘í•œë‹¤.
    + í´ë¡œì € ë‚´ìš©ì€ ê³ ê¸‰ ë‚´ìš©ì´ ë§Žë‹¤ë³´ë‹ˆ ì¶”í›„ì— í•™ìŠµì„ ì´ì–´ì„œ í•  ë“¯
```swift
let someClosure = { (parameter: Type) -> ReturnType in
    // code
    return something
}
```
---

### ë§ˆì°¸ë‚´ í´ë¡œì € ì‹¬í™”

- ì»´ê³µ ìš©ì–´ì—ì„œì˜ í´ë¡œì €ëŠ” í•¨ìˆ˜, í´ë¡œì € í‘œí˜„ì‹ ê°™ì€ ë…ë¦½ ì½”ë“œ ë¸”ë¡ì™€ ê·¸ ì£¼ë³€ì˜ ë³€ìˆ˜ê°€ ê²°í•©ëœ ê²ƒì„ ì˜ë¯¸
- ì•„ëž˜ ì˜ˆì‹œëŠ” `funcB`ê°€ ìžì‹  ìŠ¤ì½”í”„ ë°”ê¹¥ì˜ `funcA`ì˜ ë³€ìˆ˜ë¥¼ ì¡°ìž‘í•œ í›„ ë°˜í™˜í•˜ê³  ìžˆë‹¤.
- ë°”ë¡œ ê·¸ ì´ìœ  ë•Œë¬¸ì— `funcB`ëŠ” í´ë¡œì €ê°€ ë˜ì–´ `funcA`ì˜ ë°˜í™˜ ë°ì´í„°ê°€ ëœë‹¤.
    + `funcB`ëŠ” `cnt` ë³€ìˆ˜ë¥¼ ìº¡ì³í•˜ê³  ìžˆë‹¤. `funcA`ì˜ ìŠ¤íƒí”„ë ˆìž„ì´ ì¢…ë£Œë˜ì–´ë„ `funcB`ê°€ `cnt` ë³€ìˆ˜ë¥¼ ì¨ì•¼ í•˜ê¸° ë•Œë¬¸.
```swift
func funcA() -> () -> Int {
    var cnt = 0

    func funcB() -> Int {
        return cnt += 10
    }

    return funcB
}

let myClos = funcA()
print(myClos()) // 10
```
---

### í™œìš©ê³¼ í˜•íƒœ
- í´ë¡œì €ëŠ” 3ê°€ì§€ í˜•íƒœ ì¤‘ í•˜ë‚˜. í•¨ìˆ˜ëŠ” "ì´ë¦„ì´ ìžˆëŠ” í´ë¡œì €ë‹¤" ë¼ê³  ì´í•´í•´ë„ ì¢‹ë‹¤.
    + ì „ì—­ í•¨ìˆ˜ : ì´ë¦„ì„ ê°–ê³  ê°’ì„ ìº¡ì³í•˜ì§€ ì•ŠìŒ
    + ì¤‘ì²© í•¨ìˆ˜ : ì´ë¦„ìœ¼ë¡œ ë‘˜ëŸ¬ì‹¼ í•¨ìˆ˜ë¡œë¶€í„° ê°’ì„ ìº¡ì³
    + í‘œí˜„ì‹ : ì£¼ë³€ ì»¨í…ìŠ¤íŠ¸ì—ì„œ ê°’ì„ ìº¡ì³í•  ìˆ˜ ìžˆëŠ” ê²½ëŸ‰ êµ¬ë¬¸, ì´ë¦„ ì—†ìŒ
    
- í´ë¡œì €ì˜ ìž¥ì ê³¼ ìŠ¤íƒ€ì¼
    + íŒŒë¼ë¯¸í„°ì™€ ë°˜í™˜ê°’ íƒ€ìž… ì¶”ë¡ 
    + ë‹¨ì¼ í‘œí˜„ì‹ í´ë¡œì €ì˜ ì•”ì‹œì  ë°˜í™˜ ê°€ëŠ¥
    + ì•½ì‹ ì¸ìž ì´ë¦„ ($0) í™œìš©
    + í›„í–‰ í´ë¡œì € êµ¬ë¬¸
    
- í´ë¡œì € í‘œí˜„ì‹ : ì™„ì „í•œ ì„ ì–¸ê³¼ ì´ë¦„ ì—†ì´ í•¨ìˆ˜ì™€ ë™ì¼í•œ ì—­í• ì„ í•˜ëŠ” ì§§ì€ í‘œí˜„ì‹
    + í•¨ìˆ˜ë¥¼ ì¸ìžë¡œ ì‚¬ìš©í•˜ëŠ” ìž‘ì—…ì— íŠ¹ížˆ ìœ ìš©í•˜ë‹¤.
    + ê°„ë‹¨í•˜ê³  ì§‘ì¤‘ëœ ì¸ë¼ì¸ êµ¬ë¬¸ìœ¼ë¡œì„œ íŽ¸ì˜ë¥¼ ìœ„í•œ êµ¬ë¬¸ ìµœì í™”ë¥¼ ì œê³µí•œë‹¤.
    + `sorted(by:)` ì˜ˆì‹œë¡œ í•œ ë²ˆ ì•Œì•„ë³´ìž.
        * ë°°ì—´ ìš”ì†Œì˜ ë™ì¼í•œ íƒ€ìž…ì˜ ë‘ ì¸ìžë¥¼ ì“°ëŠ” í´ë¡œì €ë¥¼ í—ˆìš©í•˜ë©°, 1ë²ˆ ê°’ê³¼ 2ë²ˆ ê°’ì˜ ìˆœì„œë¥¼ ìœ„í•œ Bool ê°’ì„ ë°˜í™˜í•¨.

```swift
let names = ["HI", "Chi", "ko", "Lao"]

let sortClosure = { (_ s1: String, _ s2: String) -> Bool in
    s1 > s2
}

var reverse = names.sorted(by: sortClosure)
print(reverse) // ["ko", "Lao", "HI", "Chi"]

// ë¬¼ë¡  í´ë¡œì €ë¥¼ ì „ë‹¬í•˜ëŠ” ê²ƒì€ ì¢‹ì§€ë§Œ ì´ê²ƒì€ ë‹¤ì†Œ ê¸´ ë°©ì‹ì´ë‹¤.
// ê·¸ë ‡ë‹¤ë©´ ì–¼ë§ˆë‚˜ ë” ì¶•ì•½í•  ìˆ˜ ìžˆëŠ”ê°€? ìœ„ì—ì„œì²˜ëŸ¼ ë”°ë¡œ ë§Œë“¤ í•„ìš”ê°€ ì—†ë‹¤.
var other = names.sorted(by: { (parameter: String, parameter2: String) -> Bool in
        parameter > parameter2
    })
print(other) // ["ko", "Lao", "HI", "Chi"]

// ì•„ íƒ€ìž…ë„ ì“°ê¸° ê·€ì°®ì•„ìš”
var example = names.sorted(by: { s1, s2 -> Bool in s1 > s2 })
print(example) // ["ko", "Lao", "HI", "Chi"]

// ë¦¬í„´ íƒ€ìž…ë„ ê·€ì°®ì•„ìš”
var example2 = names.sorted(by: { s1, s2 in s1 > s2 })
print(example2) // ["ko", "Lao", "HI", "Chi"]

var finalClosure = names.sorted(by: {$0 > $1})
print(finalClosure) // ["ko", "Lao", "HI", "Chi"]

/*----------------------------------------------------------------*/


```

### í›„í–‰í´ë¡œì €(Trailing Closure)
- ê¸¸ì–´ì§€ëŠ” í´ë¡œì €ë¥¼ ë” íŽ¸í•˜ê²Œ ìž‘ì„±í•˜ê¸° ìœ„í•´ ì§€ì›í•˜ëŠ” ë¬¸ë²• ë„êµ¬
- ë§ˆì§€ë§‰ ì¸ìžë¡œ í•¨ìˆ˜ í´ë¡œì € í‘œí˜„ì‹ì„ ì „ë‹¬í•´ì•¼ í•  ê²½ìš°, ì‚¬ìš©í•˜ë©´ ìœ ìš©í•˜ë‹¤.
- ì•„ê·œë¨¼íŠ¸ ë ˆì´ë¸”ì„ ìƒëžµí•  ìˆ˜ ìžˆê³  ê¸°íƒ€ íƒ€ìž… ëª…ì‹œë‚˜ íŒŒë¼ë¯¸í„°ë„ ìž„ì˜ë¡œ ìž‘ì„±í•  ìˆ˜ ìžˆë‹¤.
    + ì´ë²ˆì—ëŠ” map() ë©”ì†Œë“œë¡œ í™•ì¸í•´ë³´ìž.
    + ë°°ì—´ì˜ ê° ìš”ì†Œë¥¼ í•˜ë‚˜ì”© êº¼ë‚´ì„œ 'ì–´ë–»ê²Œ' ì²˜ë¦¬í• ì§€ êµ¬í˜„í•˜ì—¬ ìƒˆë¡œìš´ ë°°ì—´ë¡œ ë¦¬í„´
```swift
let digitNames = [
    0: "Zero", 1: "One", 2: "Two",   3: "Three", 4: "Four",
    5: "Five", 6: "Six", 7: "Seven", 8: "Eight", 9: "Nine"
]

let numbers = [16, 58, 510]

let newArr = numbers.map { (number) -> String in
    var num = number
    var output = ""
    repeat {
        output += digitNames[num % 10]! + output
        num /= 10
    } while num > 0
    return output
}

```
---

### í›„í–‰ í´ë¡œì €ì˜ í™œìš©
- í´ë¡œì €ë¥¼ ì¡°ê±´ì— ë”°ë¼ ë¶„ê¸°ì²˜ë¦¬í•˜ëŠ” ê²ƒ ë˜í•œ ë§¤ìš° ìœ ìš©í•˜ë‹¤.
    + ì—¬ëŸ¬ ê°œì˜ í´ë¡œì €ê°€ ë™ì‹œì— ì¸ìžë¡œ ì „ë‹¬ëœë‹¤ë©´, ì²« ë²ˆì§¸ í´ë¡œì €ë§Œ íŒŒë¼ë¯¸í„° ìƒëžµì´ ê°€ëŠ¥í•˜ê³  ê·¸ ë’¤ë¶€í„°ëŠ” ë‹¤ì‹œ ë¼ë²¨ì„ ì¨ì£¼ì–´ì•¼ í•œë‹¤.
```swift
func loadPicture(from server: Server, completion: (Picture) -> Void, onFailure: () -> Void) {
    if let picture = download("photo.jpg", from: server) {
        completion(picture)
    } else {
        onFailure()
    }
}

loadPicture(from: someServer) { picture in
    someView.currentPicture = picture
} onFailure: {
    print("Couldn't download the next picture.")
}
```
---

### ë°ì´í„°ì˜ ìº¡ì³
- í´ë¡œì €ëŠ” ì •ì˜ëœ ì»¨í…ìŠ¤íŠ¸ ë‚´ì—ì„œ ìƒìˆ˜ì™€ ë³€ìˆ˜ë¥¼ ìº¡ì³í•  ìˆ˜ ìžˆë‹¤.
    + í´ë¡œì € ìŠ¤ì½”í”„ê°€ ì¢…ë£Œë˜ë”ë¼ë„ ë°”ë”” ë‚´ì—ì„œ ìƒìˆ˜ì™€ ë³€ìˆ˜ì˜ ê°’ì„ ì°¸ì¡° ë° ìˆ˜ì •í•  ìˆ˜ ìžˆë‹¤.
    + ê°•ì˜ ë‚´ìš©ì´ ê³µì‹ ë¬¸ì„œë¥¼ ë”°ë¼ê°€ê³  ìžˆìœ¼ë‹ˆ, ì¶”ê°€ ë‚´ìš©ì€ [ì•„í‹°í´](https://alisoftware.github.io/swift/closures/2016/07/25/closure-capture-1/)ì„ ì°¸ì¡°í•˜ì—¬ ë³´ì¶©í•œë‹¤.
    + í´ë¡œì €ëŠ” **ì™¸ë¶€ì˜ ê°’ì„ ê°€ì ¸ì™€ì„œ** ë°”ë”” ë‚´ì—ì„œ í•´ë‹¹ ìƒìˆ˜ì™€ ë³€ìˆ˜ì˜ ê°’ì„ ì°¸ì¡°í•˜ê³  ìˆ˜ì •í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
- ì•„í‹°í´ : í´ë¡œì €ê°€ ì§€ì†ì ìœ¼ë¡œ ë³€ê²½í•´ì•¼ í•˜ëŠ” ê°’ íƒ€ìž…ì´ë‚˜ ì°¸ì¡° íƒ€ìž…ë“¤ì€ ê·¸ëŒ€ë¡œ í´ë¡œì €ì˜ íž™ì— ë³µì‚¬ë˜ì§€ë§Œ, ê·¸ê²ƒì€ **ì°¸ì¡°**ëœë‹¤.
    + ì™œëƒí•˜ë©´ í´ë¡œì €ê°€ ìº¡ì³í•˜ëŠ” ê²ƒì€ ë°ì´í„° ìžì²´ê°€ ì•„ë‹ˆë¼ ì´ë¥¼ ì°¸ì¡°í•˜ëŠ” ì£¼ì†Œì´ê¸° ë•Œë¬¸(because it captures a reference to the variable, not the variable content itself.)
    + ë§Œì•½ ì°¸ì¡° íƒ€ìž…ì²˜ëŸ¼ ì“°ì§€ ì•Šê³  í´ë¡œì €ì˜ ì •ì˜ ì‹œì ì— ì •í•´ì§€ëŠ” ê°’ ìžì²´ë¥¼ ìƒìˆ˜ë¡œ ìœ ì§€í•˜ê³  ì‹¶ë‹¤ë©´, ìº¡ì³ë¦¬ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•œë‹¤.
        * ë°ëª¨3, ë°ëª¨5 í•¨ìˆ˜ë¥¼ ê°ê° ë¹„êµí•´ë³´ìž.
```swift
func delay(_ seconds: Int, closure: @escaping () -> ()) {
  let time = DispatchTime.now() + .seconds(seconds)
  DispatchQueue.main.asyncAfter(deadline: time) {
    print("ðŸ•‘")
    closure()
  }
}

func demo3() {
  var value = 42
  print("before closure: \(value)")
  delay(1) {
    print("inside closure: \(value)")
  }
  value = 1337
  print("after closure: \(value)")
}

/* ì¶œë ¥
before closure: 42
after closure: 1337
ðŸ•‘
inside closure: 1337
*/

func demo5() {
  var value = 42
  print("before closure: \(value)")
  delay(1) { [constValue = value] in
    print("inside closure: \(constValue)")
  }
  value = 1337
  print("after closure: \(value)")
}

/* ì¶œë ¥
before closure: 42
after closure: 1337
ðŸ•‘
inside closure: 42
*/

```
---

### ë¬¸ì œì˜ ì´ìŠ¤ì¼€ì´í•‘ í´ë¡œì €...
- í•¨ìˆ˜ ì¸ìžë¡œ ì „ë‹¬í•œ í´ë¡œì €ë¥¼ í•¨ìˆ˜ ë°˜í™˜ í›„ í˜¸ì¶œí•˜ë„ë¡ í•œë‹¤. íŒŒë¼ë¯¸í„° íƒ€ìž… ì•žì— `@escaping` í‚¤ì›Œë“œë¡œ ëª…ì‹œí•  ìˆ˜ ìžˆë‹¤.
    + ìž‘ì—…ì´ ì™„ë£Œëœ í›„ì— í´ë¡œì €ê°€ í˜¸ì¶œë˜ê¸° ë•Œë¬¸ì— í•¨ìˆ˜ì˜ ì‹¤í–‰ì´ ì™„ë£Œë˜ëŠ” ì‹œì ì— ì›í•˜ëŠ” ë™ìž‘ì„ ì •ì˜í•  ìˆ˜ ìžˆë‹¤.
    + ì ì–´ë„ ì´ìŠ¤ì¼€ì´í•‘ í´ë¡œì €ëŠ” `self`ë¥¼ ëª…ì‹œí•´ì•¼ë§Œ í•œë‹¤.
    + ë˜í•œ ì´ìŠ¤ì¼€ì´í•‘ í´ë¡œì €ëŠ” ì°¸ì¡°ì²´ì˜ ê³µìœ ë³€ê²½ì„ í—ˆìš©í•˜ê¸° ë•Œë¬¸ì— ê°’ íƒ€ìž… ì—´ê±°í˜•ê³¼ êµ¬ì¡°ì²´ëŠ” ìº¡ì³ ëŒ€ìƒì´ ë  ìˆ˜ ì—†ë‹¤.
        * **error: escaping closure captures mutating 'self' parameter**
```swift
func someFunctionWithNonescapingClosure(closure: () -> Void) {
    closure()
}

func someFunctionWithEscapingClosure(closure: @escaping () -> Void) {
    closure()
}

struct SomeStruct {
    var x = 10
    mutating func doSomething() {
        someFunctionWithNonescapingClosure { x = 200 } // Ok
        someFunctionWithEscapingClosure { self.x = 100 } // Error
        someFunctionWithEscapingClosure { x = 100 } // Error
    }
}

```